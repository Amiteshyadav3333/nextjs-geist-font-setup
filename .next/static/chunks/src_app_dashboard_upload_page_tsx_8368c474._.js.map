{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///project/sandbox/user-workspace/src/app/dashboard/upload/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef } from 'react'\nimport { useRouter } from 'next/navigation'\n\nexport default function UploadPage() {\n  const router = useRouter()\n  const [uploading, setUploading] = useState(false)\n  const [uploadError, setUploadError] = useState('')\n  const [selectedFiles, setSelectedFiles] = useState<File[]>([])\n  const [uploadProgress, setUploadProgress] = useState(0)\n  const [description, setDescription] = useState('')\n  const fileInputRef = useRef<HTMLInputElement>(null)\n  const dropRef = useRef<HTMLDivElement>(null)\n\n  useEffect(() => {\n    // Simple auth check: check if token exists in localStorage\n    const token = localStorage.getItem('enjoyable_token')\n    if (!token) {\n      router.push('/auth/login')\n    }\n  }, [router])\n\n  useEffect(() => {\n    const div = dropRef.current\n    if (!div) return\n\n    const handleDragOver = (e: DragEvent) => {\n      e.preventDefault()\n      e.stopPropagation()\n      div.classList.add('border-black', 'bg-gray-100')\n    }\n    const handleDragLeave = (e: DragEvent) => {\n      e.preventDefault()\n      e.stopPropagation()\n      div.classList.remove('border-black', 'bg-gray-100')\n    }\n    const handleDrop = (e: DragEvent) => {\n      e.preventDefault()\n      e.stopPropagation()\n      div.classList.remove('border-black', 'bg-gray-100')\n      if (e.dataTransfer?.files) {\n        const filesArray = Array.from(e.dataTransfer.files).filter(file =>\n          ['video/', 'image/', 'audio/'].some(type => file.type.startsWith(type))\n        )\n        setSelectedFiles(filesArray)\n      }\n    }\n\n    div.addEventListener('dragover', handleDragOver)\n    div.addEventListener('dragleave', handleDragLeave)\n    div.addEventListener('drop', handleDrop)\n\n    return () => {\n      div.removeEventListener('dragover', handleDragOver)\n      div.removeEventListener('dragleave', handleDragLeave)\n      div.removeEventListener('drop', handleDrop)\n    }\n  }, [])\n\n  async function handleUpload() {\n    if (selectedFiles.length === 0) {\n      setUploadError('Please select files to upload')\n      return\n    }\n    if (description.trim().split(/\\s+/).length > 1000) {\n      setUploadError('Description cannot exceed 1000 words')\n      return\n    }\n    setUploadError('')\n    setUploading(true)\n    setUploadProgress(0)\n    try {\n      const formData = new FormData()\n      selectedFiles.forEach(file => {\n        formData.append('file', file)\n      })\n      formData.append('description', description)\n\n      const xhr = new XMLHttpRequest()\n      xhr.open('POST', '/api/videos/upload')\n\n      xhr.upload.onprogress = (event) => {\n        if (event.lengthComputable) {\n          const percentComplete = Math.round((event.loaded / event.total) * 100)\n          setUploadProgress(percentComplete)\n        }\n      }\n\n      xhr.onload = () => {\n        if (xhr.status === 200) {\n          setSelectedFiles([])\n          setDescription('')\n          if (fileInputRef.current) {\n            fileInputRef.current.value = ''\n          }\n          setUploadProgress(0)\n          setUploading(false)\n        } else {\n          setUploadError('Error uploading files')\n          setUploading(false)\n        }\n      }\n\n      xhr.onerror = () => {\n        setUploadError('Error uploading files')\n        setUploading(false)\n      }\n\n      xhr.send(formData)\n    } catch (err) {\n      setUploadError('Error uploading files')\n      setUploading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen p-6 max-w-3xl mx-auto bg-white rounded-lg shadow-md flex flex-col\">\n      <h1 className=\"text-4xl font-extrabold mb-6 text-black\">Upload Files</h1>\n\n      {uploadError && <p className=\"text-red-600 mb-4\">{uploadError}</p>}\n\n      <div\n        ref={dropRef}\n        className=\"mb-4 p-6 border-2 border-dashed border-gray-400 rounded cursor-pointer text-center text-gray-600 hover:border-black transition\"\n        onClick={() => fileInputRef.current?.click()}\n      >\n        Drag & drop video, image, or audio files here or click to select files\n        <input\n          type=\"file\"\n          accept=\"video/*,image/*,audio/*\"\n          multiple\n          onChange={(e) => {\n            if (e.target.files) {\n              const filesArray = Array.from(e.target.files).filter(file =>\n                ['video/', 'image/', 'audio/'].some(type => file.type.startsWith(type))\n              )\n              setSelectedFiles(filesArray)\n            }\n          }}\n          ref={fileInputRef}\n          className=\"hidden\"\n        />\n      </div>\n\n      <textarea\n        value={description}\n        onChange={(e) => setDescription(e.target.value)}\n        placeholder=\"Write a description (max 1000 words)\"\n        className=\"w-full p-2 border border-gray-300 rounded mb-4 resize-none\"\n        rows={6}\n      />\n\n      {selectedFiles.length > 0 && (\n        <div className=\"mb-4\">\n          <h3 className=\"font-semibold text-black mb-2\">Selected Files:</h3>\n          <ul className=\"list-disc list-inside text-gray-800 max-h-32 overflow-y-auto\">\n            {selectedFiles.map((file, index) => (\n              <li key={index}>{file.name}</li>\n            ))}\n          </ul>\n        </div>\n      )}\n\n      {uploading && (\n        <div className=\"w-full bg-gray-200 rounded-full h-4 mb-4\">\n          <div\n            className=\"bg-black h-4 rounded-full transition-all\"\n            style={{ width: `${uploadProgress}%` }}\n          />\n        </div>\n      )}\n\n      <button\n        onClick={handleUpload}\n        disabled={uploading}\n        className=\"bg-black text-white px-6 py-3 rounded-md font-semibold hover:bg-gray-900 disabled:opacity-50 transition\"\n      >\n        {uploading ? `Uploading... ${uploadProgress}%` : 'Upload Files'}\n      </button>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}